setwd("~/Research/Work/fisher-bingham/support")
f.rbing=function(n,lam){
f.rbing=function(n,lam){
## lam contains the q-1 non negative eigenvalues
lam=sort(lam,decreasing=TRUE) ## sort the eigenvalues in desceding order
nsamp=0
X=NULL
lam.full=c(lam,0)
q=length(lam.full)
A=diag(lam.full)
SigACG.inv=diag(q)+2*A
SigACG=solve(SigACG.inv)
Ntry=0
while(nsamp < n) {
x.samp=FALSE
while(x.samp==FALSE) {
yp=mvrnorm(n=1,mu=rep(0,q),Sig=SigACG)
y=yp/sqrt(t(yp)%*%yp)
lratio=-t(y)%*%A%*%y -q/2*log(q) + 0.5*(q-1) + q/2*log(t(y)%*%SigACG.inv%*%y)
if(log(runif(1)) < lratio) {
X=c(X,y)
x.samp=TRUE
nsamp = nsamp+1
}
Ntry=Ntry+1 }
}
if(n>1) X=matrix(X,byrow=T,ncol=q)
## the X contains the simulated values
## the avtry is the estimate of the M in rejection sampling
## 1/M is the probability of acceptance
list(X=X,avtry=Ntry/n)
}
f.rbing
source('~/Research/Work/fisher-bingham/support/test.R')
setwd("~/Research/Work/fisher-bingham/support/R_codes")
x <- rpois(500,4)
mysummary(x)
y <- mysummary(x)
source('~/Research/Work/fisher-bingham/support/R_codes/test_function.R')
source('~/Research/Work/fisher-bingham/support/R_codes/test_function.R')
source('~/Research/Work/fisher-bingham/support/R_codes/test_function.R')
source('~/Research/Work/fisher-bingham/support/R_codes/test_function.R')
source('~/Research/Work/fisher-bingham/support/R_codes/test_function.R')
y$center
y
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
A
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
A
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
A
eigen(A)
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
A
eigen(A)
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
?mvrnorm
??mvrnorm
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
y
??export
??save
??write
write(y,"data")
class(y)
write(y,"data",sep="\t")
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
write(y[1:100,],"data",sep="\t")
write(y[1:100,],"data",sep="\t",ncolumns=3)
write(t(y[1:100,]),"data",sep="\t",ncolumns=3)
y
write(t(y[1:100,]),"rdata",sep="\t",ncolumns=3)
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
write(t(y[1:100,]),"rdata",sep="\t",ncolumns=3)
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
write(t(y[1:100,]),"rdata",sep="\t",ncolumns=3)
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
write(t(y[1:1000,]),"rdata",sep="\t",ncolumns=3)
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
source('~/Research/Work/fisher-bingham/support/R_codes/fb.R')
